#!grub

if [ "${grub_platform}" = efi ]; then
    insmod efi_gop
    insmod efi_uga
fi

# Define cmdline parameters common to all LTSP clients
regexp --set=1:m1 --set=2:m2 --set=3:m3 --set=4:m4 --set=5:m5 --set=6:m6 '^([0-9a-f]{1,2})\:([0-9a-f]{1,2})\:([0-9a-f]{1,2})\:([0-9a-f]{1,2})\:([0-9a-f]{1,2})\:([0-9a-f]{1,2})' "${net_default_mac}"
set cmdline="BOOTIF=01-${m1}-${m2}-${m3}-${m4}-${m5}-${m6}"
set default="Booty"

# Define protocol
set proto=http
set root="http,${srv}"

menuentry "Booty" --class images {
    echo "${proto}://${srv}/vmlinuz..."
    linux /vmlinuz initrd=initrd ${cmdline}
    echo "${proto}://${srv}/initrd..."
    initrd /initrd
}
